Configuring logging...
Creating platform...
Configured URL: https://api.chef-server.dev
Creating org pedant_testorg_api_16172
Validating Org Creation
Run options: include {:focus=>true, :association=>true}

All examples were filtered out; ignoring {:focus=>true, :association=>true}

Randomized with seed 23924

.................................

Finished in 1.26 seconds
33 examples, 0 failures

Randomized with seed 23924

Starting Pedant Run: 2015-05-15 19:28:45 UTC
 _______  _______  _______  _______  _______  ______   _______
|       ||       ||       ||       ||       ||      | |       |
|   _   ||    _  ||  _____||       ||   _   ||  _    ||    ___|
|  | |  ||   |_| || |_____ |       ||  | |  || | |   ||   |___
|  |_|  ||    ___||_____  ||      _||  |_|  || |_|   ||    ___|
|       ||   |     _____| ||     |_ |       ||       ||   |___
|_______||___|    |_______||_______||_______||______| |_______|

     _______  _______  ______   _______  __    _  _______
    |       ||       ||      | |   _   ||  |  | ||       |
    |    _  ||    ___||  _    ||  |_|  ||   |_| ||_     _|
    |   |_| ||   |___ | | |   ||       ||       |  |   |
    |    ___||    ___|| |_|   ||       ||  _    |  |   |
    |   |    |   |___ |       ||   _   || | |   |  |   |
    |___|    |_______||______| |__| |__||_|  |__|  |___|

                    "Accuracy Over Tact"

                  === Testing Environment ===
                 Config File: /var/opt/opscode/oc-chef-pedant/etc/pedant_config.rb
       HTTP Traffic Log File: /var/log/opscode/oc-chef-pedant/http-traffic.log

Running tests from the following directories:
/host/oc-chef-pedant/spec/api
Run options:
  include {:focus=>true, :association=>true}
  exclude {:intermittent_failure=>true, :cleanup=>true}

Randomized with seed 11587


opscode-account user association
  starting state is sane
[32m    should start with no outstanding requests[0m
    a user not in the org
[32m      has a count of 0 invites[0m
[32m      invite list is empty[0m
  /users/USER/organizations endpoint
    invoking
[32m      post fails appopriately[0m
[32m      put fails appopriately[0m
[32m      delete fails appopriately[0m
      GET
[32m        returns a proper list of orgs for the user[0m
    invoking as
[32m      superuser succeeds[0m
[32m      the user succeeds[0m
[32m      an admin org user succeeds[0m
[32m      another org member fails[0m
[32m      some other user fails[0m
  attempting to get association requests for a user that does not exist
[32m    cannot find association list[0m
[32m    cannot find association count[0m
  when org admin is attempting to view user associations
[32m    does not permit admin to view associations[0m
[32m    does not permit admin to view association count[0m
  user already in an org
[32m    cannot be invited by a non-admin[0m
  when the organization does not exist
[32m    listing association requests replies with org not found[0m
[32m    creating a new association request replies org not found[0m
  listing association requests
[32m    fails with 404 if the organization does not exist[0m
    and association requests exist
[32m      returns list of associations for the organization[0m
[32m      returns list of associations for the user[0m
[32m      returns the correct count of associations for the user[0m
    and no association requests exist
[32m      returns an empty list of association requests for the organization[0m
[32m      returns an empty list of association requests for the user[0m
  user not in org
[32m    cannot invite itself to that org[0m
[32m    cannot be invited by non-admin user in the org[0m
    can be invited to the org by an admin
[32m      unless the user is already in the org[0m
[32m      and the invite can be rescinded[0m
[32m      and a rescinded invite can't be rescinded again[0m
[32m      and once an the invite is rescinded it can't be accepted[0m
[32m      and once an the invite is rescinded it can't be rejected.[0m
[32m      and can't be invited twice[0m
[32m      and can reject an invite[0m
[32m      deleting an invite via the /users path is not accepted[0m
[32m      and can accept an invite[0m
[32m      and can reject an invite, after which they cannot access things in the org[0m
[32m      and can only response with 'accept' or 'reject'[0m
[32m      and get set up properly[0m
      after a user is deleted from an org
[32m        they do not have access to view members of that org[0m
[32m        they do not have access to attempt to view themselves in an org[0m
[32m        an org admin no longer sees them in the org[0m
[32m        admin attempting to delete this user from the org results in a 400(r)/404(e)[0m
      and a valid invite is issued
[32m        an org admin cannot accept that invite on behalf of the user[0m
[32m        the global superuser can accept the invite on behalf of the user[0m
      when the inviting admin
[32m        is removed from admins group, invites issued by that admin cannot be accepted[0m
[33m        is removed from the org, invites issued by that admin cannot be accepted (PENDING: Known failure: passes w/ 200 b/c no USAG cleanup performed for deleted user)[0m
[33m        is removed from the system, invites issued by that admin can't by accepted (PENDING: Known failure: passes w/ 200 b/c no USAG or other group cleanup performed for deleted user)[0m
      OC-11708 - when last updator of users group is dissociated
[32m        can accept the invite[0m
      belonging to another org as well
Creating org pedant-otherorg-16172
Deleting organization pedant-otherorg-16172 ...
[32m        can accept an invite, even when they belong to another org[0m
  /organizations/<org>/users endpoint
    GET /organizations/<org>/users
      admin user
[32m        can get org users[0m
      default normal user
[32m        can get org users[0m
      default client
[32m        returns 403[0m
      outside user
[32m        returns 403[0m
      invalid user
[32m        returns 401[0m
    PUT /organizations/<org>/users
      admin user
[32m        returns  404[ruby]/405[erlang][0m
    DELETE /organizations/<org>/users
      admin user
[32m        returns  404[ruby]/405[erlang][0m
  /organizations/<org>/users/<name>
    GET /organizations/<org>/users/<name>
      superuser
[32m        can get user[0m
      admin user
[32m        can get user[0m
      default normal user
[32m        can get self[0m
      default client
[32m        returns 403[0m
      outside user
[32m        returns 403[0m
      invalid user
[32m        returns 401[0m
      when requesting user that doesn't exist
[32m        returns 404[0m
    PUT /organizations/<org>/users/<name>
      admin user
[32m        returns  404[ruby]/405[erlang][0m
    POST /organizations/<org>/users/<name>
[32m      as superuser returns  404 in ruby and 405 in erlang[0m
[32m      as org admin user returns 404 in ruby and 405 in erlang[0m
[32m      as non-admin org user returns  404 in ruby and 405 in erlang[0m
    DELETE /organizations/<org>/users/<name>
      admin user
[32m        can delete user[0m
      user acting on self
[32m        when the actor is not an org admin, user can delete own association[0m
        when actor is also an org admin
[32m          cannot delete own org association[0m
[32m          prevents deletion and does not break the admin org association in the process[0m
      non-admin user
[32m        returns 403 (400 ruby - general fail)[0m
      default client
[32m        returns 403 (400 ruby - general fail)[0m
      when user doesn't exist
[32m        returns 404[0m
      OC-11708 - when last updator of users group is dissociated
        as an admin user
[32m          can delete[0m
        as a user acting on self
[32m          can delete[0m
Deleting organization pedant_testorg_api_16172 ...

Pending:
[33m  opscode-account user association user not in org can be invited to the org by an admin when the inviting admin is removed from the org, invites issued by that admin cannot be accepted[0m
[36m    # Known failure: passes w/ 200 b/c no USAG cleanup performed for deleted user[0m
[36m    # ./spec/api/account/account_association_spec.rb:652[0m
[33m  opscode-account user association user not in org can be invited to the org by an admin when the inviting admin is removed from the system, invites issued by that admin can't by accepted[0m
[36m    # Known failure: passes w/ 200 b/c no USAG or other group cleanup performed for deleted user[0m
[36m    # ./spec/api/account/account_association_spec.rb:661[0m

Finished in 52.11 seconds
[33m77 examples, 0 failures, 2 pending[0m

Randomized with seed 11587

