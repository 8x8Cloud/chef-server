#!/bin/sh

#
# make postgres stop/restart send sigint to terminate clients to postgres
# immediately.
#

RETVAL=0

case "$1" in
  stop|force-stop)
    /opt/opscode/embedded/bin/sv once postgres
    /opt/opscode/embedded/bin/sv interrupt postgres
    RETVAL=$?
    ;;
  restart)
    /opt/opscode/embedded/bin/sv once postgres
    /opt/opscode/embedded/bin/sv interrupt postgres
    sleep 5
    /opt/opscode/embedded/bin/sv start postgres
    RETVAL=$?
    ;;
	*)
		/opt/opscode/embedded/bin/sv $1 postgres
    RETVAL=$?
esac

exit $RETVAL

