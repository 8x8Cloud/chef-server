# Add your own tasks in files placed in lib/tasks ending in .rake,
# for example lib/tasks/capistrano.rake, and they will automatically be available to Rake.
if ENV['CHEF_SECRETS_FD'].nil?
  f = File.open(File.expand_path("../config/private-chef-secrets.json", __FILE__), "r")
  puts "No CHEF_SECRETS_FD set, using development secrets file at FD #{f.to_i}"
  ENV['CHEF_SECRETS_FD'] = f.to_i.to_s
end

at_exit do
  # Ensure f stays open until the at_exit handler runs
  # Note: it will be closed by veil
  f
end

require File.expand_path('../config/application', __FILE__)

OcId::Application.load_tasks

task :default => :spec
